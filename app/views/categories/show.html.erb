<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_API'] %>&callback=initMap"
async defer></script>

<script type="text/javascript">
var map;
function initMap() {
  map = new google.maps.Map(document.getElementById('multi-markers'), {
    <% if prod = @category.products.first %>
      center: {lat: <%= prod.user.latitude %>, lng: <%= prod.user.longitude %>},
    <% else %>
      center: {lat: 45.5231, lng: -122.6765},
    <% end %>
    zoom: 7,
    styles: [{"featureType":"water","stylers":[{"color":"#19a0d8"}]},{"featureType":"administrative","elementType":"labels.text.stroke","stylers":[{"color":"#ffffff"},{"weight":6}]},{"featureType":"administrative","elementType":"labels.text.fill","stylers":[{"color":"#e85113"}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"color":"#efe9e4"},{"lightness":-40}]},{"featureType":"road.arterial","elementType":"geometry.stroke","stylers":[{"color":"#efe9e4"},{"lightness":-20}]},{"featureType":"road","elementType":"labels.text.stroke","stylers":[{"lightness":100}]},{"featureType":"road","elementType":"labels.text.fill","stylers":[{"lightness":-100}]},{"featureType":"road.highway","elementType":"labels.icon"},{"featureType":"landscape","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"landscape","stylers":[{"lightness":20},{"color":"#efe9e4"}]},{"featureType":"landscape.man_made","stylers":[{"visibility":"off"}]},{"featureType":"water","elementType":"labels.text.stroke","stylers":[{"lightness":100}]},{"featureType":"water","elementType":"labels.text.fill","stylers":[{"lightness":-100}]},{"featureType":"poi","elementType":"labels.text.fill","stylers":[{"hue":"#11ff00"}]},{"featureType":"poi","elementType":"labels.text.stroke","stylers":[{"lightness":100}]},{"featureType":"poi","elementType":"labels.icon","stylers":[{"hue":"#4cff00"},{"saturation":58}]},{"featureType":"poi","elementType":"geometry","stylers":[{"visibility":"on"},{"color":"#f0e4d3"}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#efe9e4"},{"lightness":-25}]},{"featureType":"road.arterial","elementType":"geometry.fill","stylers":[{"color":"#efe9e4"},{"lightness":-10}]},{"featureType":"poi","elementType":"labels","stylers":[{"visibility":"simplified"}]}]
  });
}
</script>

<div class="row">
  <div class="col-sm-8">
    <h1><%= @category.name.titleize %> Page</h1>
    <%= image_tag(@category.image.url(:medium), :class => "category-page-image") %>
  </div>
  <div class="col-sm-4">
    <h4>Products for the <%= @category.name.capitalize %> Category</h4>
    <ul class="list-group well">
      <% @category.products.each do |product| %>
      <li class="list-group-item" align="middle">
        <%= link_to product.name, category_product_path(@category, product)%><br>
        <%= image_tag(product.image.url(:thumb)) %>
      </li>
      <br><br>
      <% end %>
    </ul>
  </div>
</div>


<div class="btn-group">
  <%= link_to "Edit Category", edit_category_path(@category), :class => "btn btn-primary" %>
  <%= link_to "Delete Category", category_path(@category), :class => "btn btn-danger", :data => {:confirm => "You Sure?", :method => 'delete'} %>
  <%= link_to "Add a product", new_category_product_path(@category), :class => "btn btn-primary" %>
</div>


<hr>

<%= link_to "Back to Homepage", categories_path %>
